#include <stdio.h>
#include "../include/arborescence.h"
#include "../include/prompt.h"
#include <stdbool.h>
#include <string.h>
#include <stdlib.h>

#define MOT 23
#define LIGNE 100

int my_mission();
int main()
{
    my_mission();
    return (0);
}
int my_mission()
{
    fichier *racine , *tmp;
    bool sortir;
    char perdue;
    int retour , nbMot;
    char **ligne;

    racine = creer(NULL , "RAC" , 1);

    my_mkdir(racine , racine , "Test");
    printf("La commande ls permet de voir le contenus d'un repertoire ;\n");
    printf("Appuiez sur entree pour continuer !\n");
    do
    {
        retour = scanf("%c" , &perdue);
        if(retour != 1)
        {
            while(getchar() != '\n');
        }
    }
    while(retour != 1);
    nbMot = 100;
    tmp = racine;
    sortir = false;
    ligne = calloc(LIGNE , sizeof(char *));
    for(nbMot=0 ; nbMot<LIGNE ; nbMot++)
    {
        ligne[nbMot] = calloc( MOT , sizeof(char));
        ligne[nbMot][0] = '\0';
    }
    while( !(sortir) )
    {
        affiche_prompt(tmp);
        
        nbMot = prend_ligne_command(ligne , LIGNE);
        retour = strcmp(ligne[0] , "ls");
        if(retour == 0)
        {
            printf("Bravo , mission reussie !\n");
        }
        tmp =  execute(ligne , tmp , nbMot);
        if(tmp == NULL)
        {
            sortir = true;
        }
        // vide le contenue precedent
        for(nbMot=0 ; nbMot<LIGNE ; nbMot++)
        {
            ligne[nbMot][0] = '\0';
        }
    }

    free(ligne);

    
    return (0);
}